
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>OPAL_PCI_GET_HUB_DIAG_DATA &#8212; skiboot v6.3-190-g9cae036fafea
 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OPAL_PCI_GET_PHB_DIAG_DATA2" href="opal-pci-get-phb-diag-data2-64.html" />
    <link rel="prev" title="OPAL_PCI_ERR_INJECT" href="opal-pci-err-inject-96.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="opal-pci-get-phb-diag-data2-64.html" title="OPAL_PCI_GET_PHB_DIAG_DATA2"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="opal-pci-err-inject-96.html" title="OPAL_PCI_ERR_INJECT"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">skiboot v6.3-190-g9cae036fafea
 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">OPAL API Documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="opal-pci-get-hub-diag-data">
<span id="id1"></span><h1>OPAL_PCI_GET_HUB_DIAG_DATA<a class="headerlink" href="#opal-pci-get-hub-diag-data" title="Permalink to this headline">¶</a></h1>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define OPAL_PCI_GET_HUB_DIAG_DATA           50</span>

<span class="k">enum</span> <span class="p">{</span>
     <span class="n">OPAL_P7IOC_DIAG_TYPE_NONE</span>       <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
     <span class="n">OPAL_P7IOC_DIAG_TYPE_RGC</span>        <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
     <span class="n">OPAL_P7IOC_DIAG_TYPE_BI</span>         <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
     <span class="n">OPAL_P7IOC_DIAG_TYPE_CI</span>         <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
     <span class="n">OPAL_P7IOC_DIAG_TYPE_MISC</span>       <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
     <span class="n">OPAL_P7IOC_DIAG_TYPE_I2C</span>        <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
     <span class="n">OPAL_P7IOC_DIAG_TYPE_LAST</span>       <span class="o">=</span> <span class="mi">6</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">OpalIoP7IOCErrorData</span> <span class="p">{</span>
     <span class="n">__be16</span> <span class="n">type</span><span class="p">;</span>

     <span class="cm">/* GEM */</span>
     <span class="n">__be64</span> <span class="n">gemXfir</span><span class="p">;</span>
     <span class="n">__be64</span> <span class="n">gemRfir</span><span class="p">;</span>
     <span class="n">__be64</span> <span class="n">gemRirqfir</span><span class="p">;</span>
     <span class="n">__be64</span> <span class="n">gemMask</span><span class="p">;</span>
     <span class="n">__be64</span> <span class="n">gemRwof</span><span class="p">;</span>

     <span class="cm">/* LEM */</span>
     <span class="n">__be64</span> <span class="n">lemFir</span><span class="p">;</span>
     <span class="n">__be64</span> <span class="n">lemErrMask</span><span class="p">;</span>
     <span class="n">__be64</span> <span class="n">lemAction0</span><span class="p">;</span>
     <span class="n">__be64</span> <span class="n">lemAction1</span><span class="p">;</span>
     <span class="n">__be64</span> <span class="n">lemWof</span><span class="p">;</span>

     <span class="k">union</span> <span class="p">{</span>
             <span class="k">struct</span> <span class="n">OpalIoP7IOCRgcErrorData</span> <span class="p">{</span>
                     <span class="n">__be64</span> <span class="n">rgcStatus</span><span class="p">;</span>       <span class="cm">/* 3E1C10 */</span>
                     <span class="n">__be64</span> <span class="n">rgcLdcp</span><span class="p">;</span>         <span class="cm">/* 3E1C18 */</span>
             <span class="p">}</span><span class="n">rgc</span><span class="p">;</span>
             <span class="k">struct</span> <span class="n">OpalIoP7IOCBiErrorData</span> <span class="p">{</span>
                     <span class="n">__be64</span> <span class="n">biLdcp0</span><span class="p">;</span>         <span class="cm">/* 3C0100, 3C0118 */</span>
                     <span class="n">__be64</span> <span class="n">biLdcp1</span><span class="p">;</span>         <span class="cm">/* 3C0108, 3C0120 */</span>
                     <span class="n">__be64</span> <span class="n">biLdcp2</span><span class="p">;</span>         <span class="cm">/* 3C0110, 3C0128 */</span>
                     <span class="n">__be64</span> <span class="n">biFenceStatus</span><span class="p">;</span>   <span class="cm">/* 3C0130, 3C0130 */</span>

                     <span class="kt">uint8_t</span> <span class="n">biDownbound</span><span class="p">;</span>    <span class="cm">/* BI Downbound or Upbound */</span>
             <span class="p">}</span><span class="n">bi</span><span class="p">;</span>
             <span class="k">struct</span> <span class="n">OpalIoP7IOCCiErrorData</span> <span class="p">{</span>
                     <span class="n">__be64</span> <span class="n">ciPortStatus</span><span class="p">;</span>    <span class="cm">/* 3Dn008 */</span>
                     <span class="n">__be64</span> <span class="n">ciPortLdcp</span><span class="p">;</span>      <span class="cm">/* 3Dn010 */</span>

                     <span class="kt">uint8_t</span> <span class="n">ciPort</span><span class="p">;</span>         <span class="cm">/* Index of CI port: 0/1 */</span>
             <span class="p">}</span><span class="n">ci</span><span class="p">;</span>
     <span class="p">};</span>
<span class="p">};</span>

<span class="kt">int64_t</span> <span class="nf">opal_pci_get_hub_diag_data</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="n">hub_id</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">diag_buffer</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="n">diag_buffer_len</span><span class="p">);</span>
</pre></div>
</div>
<p>Fetch diagnostic data for an IO hub. Currently, this is only implemented for
p7ioc, which is specific to POWER7, something that was only ever available
internally to IBM for development purposes.</p>
<p>If <a class="reference internal" href="opal-pci-next-error-60.html#opal-pci-next-error"><span class="std std-ref">OPAL_PCI_NEXT_ERROR</span></a> error type is <cite>OPAL_EEH_IOC_ERROR</cite> and severity
is <cite>OPAL_EEH_SEV_INF</cite>, then the OS should call <a class="reference internal" href="#opal-pci-get-hub-diag-data"><span class="std std-ref">OPAL_PCI_GET_HUB_DIAG_DATA</span></a>
to retreive diagnostic data to log appropriately.</p>
<div class="section" id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><a class="reference internal" href="return-codes.html#opal-success"><span class="std std-ref">OPAL_SUCCESS</span></a></dt>
<dd>Diagnostic data copied successfully</dd>
<dt><a class="reference internal" href="return-codes.html#opal-parameter"><span class="std std-ref">OPAL_PARAMETER</span></a></dt>
<dd>Invalid address, invalid hub ID, or insufficient space in buffer for
diagnostic data.</dd>
<dt><a class="reference internal" href="return-codes.html#opal-unsupported"><span class="std std-ref">OPAL_UNSUPPORTED</span></a></dt>
<dd>hub doesn’t support retreiving diagnostic data.</dd>
<dt><a class="reference internal" href="return-codes.html#opal-closed"><span class="std std-ref">OPAL_CLOSED</span></a></dt>
<dd>No pending error.</dd>
<dt><a class="reference internal" href="return-codes.html#opal-internal-error"><span class="std std-ref">OPAL_INTERNAL_ERROR</span></a></dt>
<dd>Something went wrong.</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">OPAL_PCI_GET_HUB_DIAG_DATA</a><ul>
<li><a class="reference internal" href="#returns">Returns</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="opal-pci-err-inject-96.html"
                        title="previous chapter">OPAL_PCI_ERR_INJECT</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="opal-pci-get-phb-diag-data2-64.html"
                        title="next chapter">OPAL_PCI_GET_PHB_DIAG_DATA2</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/opal-api/opal-pci-get-hub-diag-data-50.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="opal-pci-get-phb-diag-data2-64.html" title="OPAL_PCI_GET_PHB_DIAG_DATA2"
             >next</a> |</li>
        <li class="right" >
          <a href="opal-pci-err-inject-96.html" title="OPAL_PCI_ERR_INJECT"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">skiboot v6.3-190-g9cae036fafea
 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >OPAL API Documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2017, IBM, others.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>